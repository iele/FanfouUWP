<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:FanfouWP2"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ItemControl="using:FanfouWP2.ItemControl"
    x:Class="FanfouWP2.HomePage"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" RequestedTheme="Light" Width="Auto" Height="Auto" IsTextScaleFactorEnabled="True"
    DataContext="{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}">
    <Page.Resources>
        <DataTemplate x:Key="StatusItemControl">
            <ItemControl:StatusItemControl  DataContext="{Binding}" Width="{Binding ActualWidth, ElementName=statusesGridView}"
              Margin="0,3"/>
        </DataTemplate>
        <DataTemplate x:Key="MentionsItemControl">
            <ItemControl:StatusItemControl  DataContext="{Binding}" Width="{Binding ActualWidth, ElementName=mentionsGridView}"
              Margin="0,3"/>
        </DataTemplate>
        <DataTemplate x:Key="DataTemplate"/>
    </Page.Resources>

    <Grid Margin="0,0,0,0" x:Name="LayoutRoot" Background="#33808080">
    	<Grid.RowDefinitions>
    		<RowDefinition Height="72"/>
    		<RowDefinition/>
    	</Grid.RowDefinitions>

        <Rectangle Fill="DeepSkyBlue" Height="28" Stroke="DeepSkyBlue" StrokeThickness="2" VerticalAlignment="Top" Margin="0,-28,0,0"/>
        <Grid Margin="0,0,0,12" Background="DeepSkyBlue">
        	<StackPanel Margin="0" Height="60" Orientation="Horizontal" HorizontalAlignment="Left">
        		<Rectangle HorizontalAlignment="Left" Height="40" Stroke="DeepSkyBlue" StrokeThickness="2" VerticalAlignment="Center" Width="40" Margin="12,0,0,0">
        			<Rectangle.Fill>
        				<ImageBrush Stretch="Fill" ImageSource="{Binding currentUser.profile_image_url}"/>
        			</Rectangle.Fill>
        		</Rectangle>
        		<TextBlock TextWrapping="Wrap" Text="{Binding currentUser.screen_name}" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontSize="21.333"/>
        	</StackPanel>
        	<Image Margin="0,0,12,0" Source="/Assets/fanfou_beta.png" HorizontalAlignment="Right" Width="120"/>

        </Grid>

        <Hub Header="" Margin="0,26,0,0" Orientation="Horizontal" HeaderTemplate="{StaticResource DataTemplate}" Grid.Row="1">
            <HubSection x:Name="statusesSection" Header="我的消息" Height="Auto">
                <DataTemplate>
                    <Grid>
                        <ListView x:Name="statusesGridView"  ItemsSource="{Binding statuses}" ItemTemplate="{StaticResource StatusItemControl}" Margin="0,-20,0,0" />
                    </Grid>
                </DataTemplate>
            </HubSection>
            <HubSection Header="提及我的">
                <DataTemplate>
                    <Grid>
                        <ListView x:Name="mentionsGridView"  ItemsSource="{Binding mentions}" ItemTemplate="{StaticResource MentionsItemControl}" Margin="0,-20,0,0"/>
                    </Grid>
                </DataTemplate>
            </HubSection>
            <HubSection Header="更多"/>
        </Hub>
        <ProgressBar x:Name="loading" Height="10" VerticalAlignment="Top" IsIndeterminate="True" Canvas.ZIndex="10"/>
    </Grid>
</Page>
